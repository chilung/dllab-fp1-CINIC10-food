#The transform function for train data
transform_train = transforms.Compose([
    transforms.RandomHorizontalFlip(),
    transforms.RandomVerticalFlip(),
    transforms.RandomRotation((-180,180)),
    transforms.RandomAffine(degrees=(-30,30), shear=(-20,20)),
    #transforms.Resize(256),
    #transforms.CenterCrop(224),
    transforms.RandomResizedCrop(224),
    transforms.ToTensor(),
    transforms.Normalize(train_mean, train_std)
])

#The transform function for validation data
transform_val = transforms.Compose([
    transforms.Resize(256),
    transforms.CenterCrop(224),
    transforms.ToTensor(),
    transforms.Normalize(val_mean, val_std)
])

#The transform function for test data
transform_test = transforms.Compose([
    transforms.Resize(256),
    transforms.CenterCrop(224),
    transforms.ToTensor(),
    transforms.Normalize(test_mean, test_std)
])

optimizer = optim.SGD(model.parameters(), lr=0.001, momentum=0.9, weight_decay=0.001)

cuda
[1,   200]
[1,   400]
[1,   600]
[1,   800]
[1,  1000]
[1,  1200]
[1,  1400]
[1,  1600]
[1,  1800]
[1,  2000]
[1,  2200]
[1,  2400]
[1,  2600]
[1,  2800]
0 Epoch train Loss: 0.0612 Acc: 0.2736
[1,   200]
[1,   400]
[1,   600]
[1,   800]
[1,  1000]
[1,  1200]
[1,  1400]
[1,  1600]
[1,  1800]
[1,  2000]
[1,  2200]
[1,  2400]
[1,  2600]
[1,  2800]
0 Epoch val Loss: 0.0567 Acc: 0.3306
[2,   200]
[2,   400]
[2,   600]
[2,   800]
[2,  1000]
[2,  1200]
[2,  1400]
[2,  1600]
[2,  1800]
[2,  2000]
[2,  2200]
[2,  2400]
[2,  2600]
[2,  2800]
1 Epoch train Loss: 0.0580 Acc: 0.3151
[2,   200]
[2,   400]
[2,   600]
[2,   800]
[2,  1000]
[2,  1200]
[2,  1400]
[2,  1600]
[2,  1800]
[2,  2000]
[2,  2200]
[2,  2400]
[2,  2600]
[2,  2800]
1 Epoch val Loss: 0.0561 Acc: 0.3391
[3,   200]
[3,   400]
[3,   600]
[3,   800]
[3,  1000]
[3,  1200]
[3,  1400]
[3,  1600]
[3,  1800]
[3,  2000]
[3,  2200]
[3,  2400]
[3,  2600]
[3,  2800]
2 Epoch train Loss: 0.0565 Acc: 0.3349
[3,   200]
[3,   400]
[3,   600]
[3,   800]
[3,  1000]
[3,  1200]
[3,  1400]
[3,  1600]
[3,  1800]
[3,  2000]
[3,  2200]
[3,  2400]
[3,  2600]
[3,  2800]
2 Epoch val Loss: 0.0528 Acc: 0.3813
[4,   200]
[4,   400]
[4,   600]
[4,   800]
[4,  1000]
[4,  1200]
[4,  1400]
[4,  1600]
[4,  1800]
[4,  2000]
[4,  2200]
[4,  2400]
[4,  2600]
[4,  2800]
3 Epoch train Loss: 0.0554 Acc: 0.3508
[4,   200]
[4,   400]
[4,   600]
[4,   800]
[4,  1000]
[4,  1200]
[4,  1400]
[4,  1600]
[4,  1800]
[4,  2000]
[4,  2200]
[4,  2400]
[4,  2600]
[4,  2800]
3 Epoch val Loss: 0.0517 Acc: 0.3988
[5,   200]
[5,   400]
[5,   600]
[5,   800]
[5,  1000]
[5,  1200]
[5,  1400]
[5,  1600]
[5,  1800]
[5,  2000]
[5,  2200]
[5,  2400]
[5,  2600]
[5,  2800]
4 Epoch train Loss: 0.0541 Acc: 0.3674
[5,   200]
[5,   400]
[5,   600]
[5,   800]
[5,  1000]
[5,  1200]
[5,  1400]
[5,  1600]
[5,  1800]
[5,  2000]
[5,  2200]
[5,  2400]
[5,  2600]
[5,  2800]
4 Epoch val Loss: 0.0492 Acc: 0.4296
[6,   200]
[6,   400]
[6,   600]
[6,   800]
[6,  1000]
[6,  1200]
[6,  1400]
[6,  1600]
[6,  1800]
[6,  2000]
[6,  2200]
[6,  2400]
[6,  2600]
[6,  2800]
5 Epoch train Loss: 0.0531 Acc: 0.3809
[6,   200]
[6,   400]
[6,   600]
[6,   800]
[6,  1000]
[6,  1200]
[6,  1400]
[6,  1600]
[6,  1800]
[6,  2000]
[6,  2200]
[6,  2400]
[6,  2600]
[6,  2800]
5 Epoch val Loss: 0.0530 Acc: 0.4005
[7,   200]
[7,   400]
[7,   600]
[7,   800]
[7,  1000]
[7,  1200]
[7,  1400]
[7,  1600]
[7,  1800]
[7,  2000]
[7,  2200]
[7,  2400]
[7,  2600]
[7,  2800]
6 Epoch train Loss: 0.0522 Acc: 0.3931
[7,   200]
[7,   400]
[7,   600]
[7,   800]
[7,  1000]
[7,  1200]
[7,  1400]
[7,  1600]
[7,  1800]
[7,  2000]
[7,  2200]
[7,  2400]
[7,  2600]
[7,  2800]
6 Epoch val Loss: 0.0495 Acc: 0.4352
[8,   200]
[8,   400]
[8,   600]
[8,   800]
[8,  1000]
[8,  1200]
[8,  1400]
[8,  1600]
[8,  1800]
[8,  2000]
[8,  2200]
[8,  2400]
[8,  2600]
[8,  2800]
7 Epoch train Loss: 0.0513 Acc: 0.4046
[8,   200]
[8,   400]
[8,   600]
[8,   800]
[8,  1000]
[8,  1200]
[8,  1400]
[8,  1600]
[8,  1800]
[8,  2000]
[8,  2200]
[8,  2400]
[8,  2600]
[8,  2800]
7 Epoch val Loss: 0.0465 Acc: 0.4614
[9,   200]
[9,   400]
[9,   600]
[9,   800]
[9,  1000]
[9,  1200]
[9,  1400]
[9,  1600]
[9,  1800]
[9,  2000]
[9,  2200]
[9,  2400]
[9,  2600]
[9,  2800]
8 Epoch train Loss: 0.0505 Acc: 0.4137
[9,   200]
[9,   400]
[9,   600]
[9,   800]
[9,  1000]
[9,  1200]
[9,  1400]
[9,  1600]
[9,  1800]
[9,  2000]
[9,  2200]
[9,  2400]
[9,  2600]
[9,  2800]
8 Epoch val Loss: 0.0466 Acc: 0.4617
[10,   200]
[10,   400]
[10,   600]
[10,   800]
[10,  1000]
[10,  1200]
[10,  1400]
[10,  1600]
[10,  1800]
[10,  2000]
[10,  2200]
[10,  2400]
[10,  2600]
[10,  2800]
9 Epoch train Loss: 0.0497 Acc: 0.4245
[10,   200]
[10,   400]
[10,   600]
[10,   800]
[10,  1000]
[10,  1200]
[10,  1400]
[10,  1600]
[10,  1800]
[10,  2000]
[10,  2200]
[10,  2400]
[10,  2600]
[10,  2800]
9 Epoch val Loss: 0.0458 Acc: 0.4695
[11,   200]
[11,   400]
[11,   600]
[11,   800]
[11,  1000]
[11,  1200]
[11,  1400]
[11,  1600]
[11,  1800]
[11,  2000]
[11,  2200]
[11,  2400]
[11,  2600]
[11,  2800]
10 Epoch train Loss: 0.0489 Acc: 0.4308
[11,   200]
[11,   400]
[11,   600]
[11,   800]
[11,  1000]
[11,  1200]
[11,  1400]
[11,  1600]
[11,  1800]
[11,  2000]
[11,  2200]
[11,  2400]
[11,  2600]
[11,  2800]
10 Epoch val Loss: 0.0441 Acc: 0.4930
[12,   200]
[12,   400]
[12,   600]
[12,   800]
[12,  1000]
[12,  1200]
[12,  1400]
[12,  1600]
[12,  1800]
[12,  2000]
[12,  2200]
[12,  2400]
[12,  2600]
[12,  2800]
11 Epoch train Loss: 0.0482 Acc: 0.4419
[12,   200]
[12,   400]
[12,   600]
[12,   800]
[12,  1000]
[12,  1200]
[12,  1400]
[12,  1600]
[12,  1800]
[12,  2000]
[12,  2200]
[12,  2400]
[12,  2600]
[12,  2800]
11 Epoch val Loss: 0.0461 Acc: 0.4783
Epoch    11: reducing learning rate of group 0 to 1.0000e-04.
[13,   200]
[13,   400]
[13,   600]
[13,   800]
[13,  1000]
[13,  1200]
[13,  1400]
[13,  1600]
[13,  1800]
[13,  2000]
[13,  2200]
[13,  2400]
[13,  2600]
[13,  2800]
12 Epoch train Loss: 0.0458 Acc: 0.4733
[13,   200]
[13,   400]
[13,   600]
[13,   800]
[13,  1000]
[13,  1200]
[13,  1400]
[13,  1600]
[13,  1800]
[13,  2000]
[13,  2200]
[13,  2400]
[13,  2600]
[13,  2800]
12 Epoch val Loss: 0.0406 Acc: 0.5347
[14,   200]
[14,   400]
[14,   600]
[14,   800]
[14,  1000]
[14,  1200]
[14,  1400]
[14,  1600]
[14,  1800]
[14,  2000]
[14,  2200]
[14,  2400]
[14,  2600]
[14,  2800]
13 Epoch train Loss: 0.0454 Acc: 0.4783
[14,   200]
[14,   400]
[14,   600]
[14,   800]
[14,  1000]
[14,  1200]
[14,  1400]
[14,  1600]
[14,  1800]
[14,  2000]
[14,  2200]
[14,  2400]
[14,  2600]
[14,  2800]
13 Epoch val Loss: 0.0400 Acc: 0.5398
[15,   200]
[15,   400]
[15,   600]
[15,   800]
[15,  1000]
[15,  1200]
[15,  1400]
[15,  1600]
[15,  1800]
[15,  2000]
[15,  2200]
[15,  2400]
[15,  2600]
[15,  2800]
14 Epoch train Loss: 0.0451 Acc: 0.4798
[15,   200]
[15,   400]
[15,   600]
[15,   800]
[15,  1000]
[15,  1200]
[15,  1400]
[15,  1600]
[15,  1800]
[15,  2000]
[15,  2200]
[15,  2400]
[15,  2600]
[15,  2800]
14 Epoch val Loss: 0.0399 Acc: 0.5410
[16,   200]
[16,   400]
[16,   600]
[16,   800]
[16,  1000]
[16,  1200]
[16,  1400]
[16,  1600]
[16,  1800]
[16,  2000]
[16,  2200]
[16,  2400]
[16,  2600]
[16,  2800]
15 Epoch train Loss: 0.0449 Acc: 0.4838
[16,   200]
[16,   400]
[16,   600]
[16,   800]
[16,  1000]
[16,  1200]
[16,  1400]
[16,  1600]
[16,  1800]
[16,  2000]
[16,  2200]
[16,  2400]
[16,  2600]
[16,  2800]
15 Epoch val Loss: 0.0393 Acc: 0.5492
[17,   200]
[17,   400]
[17,   600]
[17,   800]
[17,  1000]
[17,  1200]
[17,  1400]
[17,  1600]
[17,  1800]
[17,  2000]
[17,  2200]
[17,  2400]
[17,  2600]
[17,  2800]
16 Epoch train Loss: 0.0448 Acc: 0.4848
[17,   200]
[17,   400]
[17,   600]
[17,   800]
[17,  1000]
[17,  1200]
[17,  1400]
[17,  1600]
[17,  1800]
[17,  2000]
[17,  2200]
[17,  2400]
[17,  2600]
[17,  2800]
16 Epoch val Loss: 0.0395 Acc: 0.5452
[18,   200]
[18,   400]
[18,   600]
[18,   800]
[18,  1000]
[18,  1200]
[18,  1400]
[18,  1600]
[18,  1800]
[18,  2000]
[18,  2200]
[18,  2400]
[18,  2600]
[18,  2800]
17 Epoch train Loss: 0.0446 Acc: 0.4862
[18,   200]
[18,   400]
[18,   600]
[18,   800]
[18,  1000]
[18,  1200]
[18,  1400]
[18,  1600]
[18,  1800]
[18,  2000]
[18,  2200]
[18,  2400]
[18,  2600]
[18,  2800]
17 Epoch val Loss: 0.0396 Acc: 0.5486
[19,   200]
[19,   400]
[19,   600]
[19,   800]
[19,  1000]
[19,  1200]
[19,  1400]
[19,  1600]
[19,  1800]
[19,  2000]
[19,  2200]
[19,  2400]
[19,  2600]
[19,  2800]
18 Epoch train Loss: 0.0443 Acc: 0.4900
[19,   200]
[19,   400]
[19,   600]
[19,   800]
[19,  1000]
[19,  1200]
[19,  1400]
[19,  1600]
[19,  1800]
[19,  2000]
[19,  2200]
[19,  2400]
[19,  2600]
[19,  2800]
18 Epoch val Loss: 0.0393 Acc: 0.5475
[20,   200]
[20,   400]
[20,   600]
[20,   800]
[20,  1000]
[20,  1200]
[20,  1400]
[20,  1600]
[20,  1800]
[20,  2000]
[20,  2200]
[20,  2400]
[20,  2600]
[20,  2800]
19 Epoch train Loss: 0.0442 Acc: 0.4920
[20,   200]
[20,   400]
[20,   600]
[20,   800]
[20,  1000]
[20,  1200]
[20,  1400]
[20,  1600]
[20,  1800]
[20,  2000]
[20,  2200]
[20,  2400]
[20,  2600]
[20,  2800]
19 Epoch val Loss: 0.0387 Acc: 0.5540
[21,   200]
[21,   400]
[21,   600]
[21,   800]
[21,  1000]
[21,  1200]
[21,  1400]
[21,  1600]
[21,  1800]
[21,  2000]

[21,  2200]
[21,  2400]
[21,  2600]
[21,  2800]
20 Epoch train Loss: 0.0440 Acc: 0.4932
[21,   200]
[21,   400]
[21,   600]
[21,   800]
[21,  1000]
[21,  1200]
[21,  1400]
[21,  1600]
[21,  1800]
[21,  2000]
[21,  2200]
[21,  2400]
[21,  2600]
[21,  2800]
20 Epoch val Loss: 0.0390 Acc: 0.5516
[22,   200]
[22,   400]
[22,   600]
[22,   800]
[22,  1000]
[22,  1200]
[22,  1400]
[22,  1600]
[22,  1800]
[22,  2000]
[22,  2200]
[22,  2400]
[22,  2600]
[22,  2800]
21 Epoch train Loss: 0.0439 Acc: 0.4953
[22,   200]
[22,   400]
[22,   600]
[22,   800]
[22,  1000]
[22,  1200]
[22,  1400]
[22,  1600]
[22,  1800]
[22,  2000]
[22,  2200]
[22,  2400]
[22,  2600]
[22,  2800]
21 Epoch val Loss: 0.0382 Acc: 0.5610
[23,   200]
[23,   400]
[23,   600]
[23,   800]
[23,  1000]
[23,  1200]
[23,  1400]
[23,  1600]
[23,  1800]
[23,  2000]
[23,  2200]
[23,  2400]
[23,  2600]
[23,  2800]
22 Epoch train Loss: 0.0437 Acc: 0.4966
[23,   200]
[23,   400]
[23,   600]
[23,   800]
[23,  1000]
[23,  1200]
[23,  1400]
[23,  1600]
[23,  1800]
[23,  2000]
[23,  2200]
[23,  2400]
[23,  2600]
[23,  2800]
22 Epoch val Loss: 0.0381 Acc: 0.5634
